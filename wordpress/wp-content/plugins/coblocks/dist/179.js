"use strict";(self.webpackChunkcoblocks=self.webpackChunkcoblocks||[]).push([[179],{179:function(e,t,o){o.r(t),o.d(t,{default:function(){return T}});var l=o(7462),n=o(9307),r=o(4184),a=o.n(r),s=o(6066),c=o(2819),i=o(7635),d=o(5736),u=o(2175),m=o(5609),g=e=>{const{attributes:t,categoriesList:o,hasPosts:l,postCount:r,setAttributes:a,useUpdatedQueryControls:s}=e,{displayPostContent:c,displayPostDate:i,excerptLength:g,order:p,orderBy:b,postFeedType:_,postsToShow:h,columns:k,categories:y,categoryRelation:E}=t,C=(0,n.createElement)(m.PanelBody,{title:(0,d.__)("Post Carousel settings","coblocks")},(0,n.createElement)(n.Fragment,null,(0,n.createElement)(m.ToggleControl,{label:(0,d.__)("Post date","coblocks"),checked:i,help:i?(0,d.__)("Showing the publish date.","coblocks"):(0,d.__)("Toggle to show the publish date.","coblocks"),onChange:()=>a({displayPostDate:!i})}),(0,n.createElement)(m.ToggleControl,{label:(0,d.__)("Post content","coblocks"),checked:c,help:c?(0,d.__)("Showing the post content.","coblocks"):(0,d.__)("Toggle to show the post content.","coblocks"),onChange:()=>a({displayPostContent:!c})}),c&&(0,n.createElement)(m.RangeControl,{label:(0,d.__)("Max words in content","coblocks"),value:g,onChange:e=>a({excerptLength:e}),min:5,max:75}),(0,n.createElement)(m.RangeControl,{label:(0,d.__)("Columns","coblocks"),value:k,onChange:e=>{var t;a({columns:(t=e)>h?h:t})},min:1,max:Math.min(4,r),required:!0}))),f=(0,n.createElement)(m.QueryControls,{order:p,orderBy:b,categoriesList:o,selectedCategoryId:t.categories,onOrderChange:e=>a({order:e}),onOrderByChange:e=>a({orderBy:e}),onCategoryChange:e=>a({categories:""!==e?e:void 0})});return(0,n.createElement)(u.InspectorControls,null,l?C:null,(0,n.createElement)(m.PanelBody,{title:(0,d.__)("Feed settings","coblocks"),initialOpen:!l},(0,n.createElement)(m.RadioControl,{selected:_,options:[{label:(0,d.__)("My blog","coblocks"),value:"internal"},{label:(0,d.__)("External feed","coblocks"),value:"external"}],onChange:e=>a({postFeedType:e})}),l||y&&(null==y?void 0:y.length)>0?(0,n.createElement)(n.Fragment,null,"internal"===_&&s?(()=>{const e=o.reduce(((e,t)=>({...e,[t.name]:t})),{}),l=o.reduce(((e,t)=>({...e,[t.name]:t})),{});return(0,n.createElement)(m.QueryControls,{order:p,orderBy:b,categorySuggestions:e,selectedCategories:t.categories,onOrderChange:e=>a({order:e}),onOrderByChange:e=>a({orderBy:e}),onCategoryChange:e=>{const t=e.reduce(((e,t)=>{if("string"==typeof t){const o=l[t];o&&e.push(o)}else e.push(t);return e}),[]);a({categories:t}),e.length<2&&a({categoryRelation:"or"})}})})():f,y&&y.length>1&&(0,n.createElement)(m.RadioControl,{label:(0,d.__)("Category relation","coblocks"),help:(0,d.__)("The logical relationship between each category when there is more than one.","coblocks"),selected:E,options:[{label:(0,d.__)("Or","coblocks"),value:"or"},{label:(0,d.__)("And","coblocks"),value:"and"}],onChange:e=>a({categoryRelation:e})}),(0,n.createElement)(m.RangeControl,{label:(0,d.__)("Number of posts","coblocks"),value:h,onChange:e=>(e=>{const t={postsToShow:e};(k>e||1===e&&1!==k)&&Object.assign(t,{columns:e}),a(t)})(e),min:1,max:20})):null))},p=o(6989),b=o.n(p),_=o(4333),h=o(6483),k=o(9771),y=o(9818),E=o(8423),C=o.n(E),f=o(4896);const S={per_page:-1};var T=(0,_.compose)([(0,y.withSelect)(((e,t)=>{const{postsToShow:o,order:l,orderBy:n,categories:r,categoryRelation:a}=t.attributes,{getEntityRecords:s,getMedia:i}=e("core"),{getEditorSettings:d,getCurrentPost:u}=e("core/editor"),{isRTL:g}=d(),p=u(),b=m.QueryControls.toString().includes("selectedCategories");return{latestPosts:b?(()=>{const e=r&&r.length>0?r.map((e=>null==e?void 0:e.id)):[],t=(0,c.pickBy)({categories:e,order:l,orderby:n,per_page:"and"===a?"-1":o,exclude:p.id},(e=>!(0,c.isUndefined)(e)));let d=s("postType","post",t);return"and"===a&&d&&(d=d.filter((t=>(0,c.isEqual)(t.categories.concat().sort(),e.concat().sort()))).slice(0,o)),Array.isArray(d)?d.map((e=>{if(e.featured_media){const t=i(e.featured_media);let o=(0,c.get)(t,["media_details","sizes","source_url"],null);return o||(o=(0,c.get)(t,"source_url",null)),{...e,featuredImageSourceUrl:o}}return e})):d})():(()=>{const t=(0,c.pickBy)({categories:r,order:l,orderby:n,per_page:o,exclude:p.id},(e=>!(0,c.isUndefined)(e)));let a=s("postType","post",t);return a&&(a=a.map((t=>({...t,featured_media_object:t.featured_media&&e("core").getMedia(t.featured_media)})))),a})(),useUpdatedQueryControls:b,isRTL:g}}))])((e=>{const{attributes:t,setAttributes:o,latestPosts:r,className:c,isRTL:p}=e,{displayPostContent:_,displayPostDate:y,displayPostLink:E,excerptLength:T,externalRssUrl:w,postFeedType:v,postLink:x,postsToShow:R,columns:P,align:L}=t,[B,N]=(0,n.useState)([]),[F,A]=(0,n.useState)(w);let U=(0,n.useRef)(!0);(0,n.useEffect)((()=>(b()({path:(0,h.addQueryArgs)("/wp/v2/categories",S)}).then((e=>{U&&N(e)})).catch((()=>{U&&N([])})),()=>{U=!1})),[]),(0,n.useEffect)((()=>{E&&!_&&o({displayPostLink:!1})}),[E,_]);const M=[{icon:f.Z,title:(0,d.__)("Edit RSS URL","coblocks"),onClick:()=>A(!0)}],I=Array.isArray(r)&&r.length,O=Array.isArray(r)&&r.length>R?r.slice(0,R):r,Q={dots:!1,arrows:!0,infinite:!0,draggable:!0,adaptiveHeight:!1,speed:500,slidesToShow:P,slidesToScroll:p?-1:1,rtl:!!p,responsive:[{breakpoint:1024,settings:{slidesToShow:3}},{breakpoint:600,settings:{slidesToShow:2}},{breakpoint:480,settings:{slidesToShow:1}}]},Z=(0,k.__experimentalGetSettings)().formats.date;return I||"internal"!==v?F&&"external"===v?(0,n.createElement)(n.Fragment,null,(0,n.createElement)(g,(0,l.Z)({},e,{attributes:t,hasPosts:I,editing:F,categoriesList:B,postCount:r&&r.length})),(0,n.createElement)(m.Placeholder,{icon:(0,n.createElement)(m.Icon,{icon:i.tPc}),label:(0,d.__)("RSS Feed","coblocks"),instructions:(0,d.__)("RSS URLs are generally located at the /feed/ directory of a site.","coblocks")},(0,n.createElement)("form",{onSubmit:e=>{e.preventDefault(),w&&A(!1)}},(0,n.createElement)(m.TextControl,{placeholder:(0,d.__)("https://example.com/feedâ€¦","coblocks"),value:w,onChange:e=>o({externalRssUrl:e}),className:"components-placeholder__input"}),(0,n.createElement)(m.Button,{type:"submit",disabled:!w},(0,d.__)("Use URL","coblocks"))))):(0,n.createElement)(n.Fragment,null,(0,n.createElement)(g,(0,l.Z)({},e,{attributes:t,hasPosts:I,editing:F,categoriesList:B,postCount:r&&r.length})),(0,n.createElement)(u.BlockControls,null,"external"===v&&(0,n.createElement)(m.Toolbar,{controls:M})),"external"===v&&(0,n.createElement)(C(),{block:"coblocks/post-carousel",attributes:t,className:"coblocks-slick pb-8"}),"internal"===v&&(0,n.createElement)(n.Fragment,null,(0,n.createElement)("div",{className:a()(c,{[`align${L}`]:L})},(0,n.createElement)(s.Z,(0,l.Z)({className:"coblocks-slick pb-8"},Q),O.map(((e,t)=>{const l=e.featured_media_object?e.featured_media_object.source_url:null,r="url("+l+")",s=e.title.rendered.trim();let c=e.excerpt.rendered;""===e.excerpt.raw&&(c=e.content.raw);const i=document.createElement("div");return i.innerHTML=c,c=i.textContent||i.innerText||"",(0,n.createElement)("div",{className:"wp-block-coblocks-post-carousel__item",key:t},l&&(0,n.createElement)("div",{className:"wp-block-coblocks-post-carousel__image"},(0,n.createElement)("div",{className:"bg-cover bg-center-center",style:{backgroundImage:r}})),(0,n.createElement)("div",{className:a()("wp-block-coblocks-post-carousel__content",{"full-height":!l})},y&&e.date_gmt&&(0,n.createElement)("time",{dateTime:(0,k.format)("c",e.date_gmt),className:"wp-block-coblocks-post-carousel__date"},(0,k.dateI18n)(Z,e.date_gmt)),(0,n.createElement)(m.Disabled,null,(0,n.createElement)("a",{href:e.link,target:"_blank",rel:"noreferrer noopener",alt:s},s?(0,n.createElement)(n.RawHTML,null,s)
/* translators: placeholder when a post has no title */:(0,d.__)("(no title)","coblocks"))),_&&(0,n.createElement)("div",{className:"wp-block-coblocks-post-carousel__excerpt"},(0,n.createElement)(n.RawHTML,{key:"html"},c.trim().split(" ",T).join(" "))),E&&(0,n.createElement)(u.PlainText,{className:"wp-block-coblocks-post-carousel__more-link",onChange:e=>o({postLink:e}),value:x,placeholder:(0,d.__)("Read more","coblocks")})))})))))):(0,n.createElement)(n.Fragment,null,(0,n.createElement)(g,(0,l.Z)({},e,{attributes:t,hasPosts:I,editing:F,categoriesList:B,postCount:r&&r.length})),(0,n.createElement)(m.Placeholder,{icon:(0,n.createElement)(m.Icon,{icon:i.tPc}),label:(0,d.__)("Post Carousel","coblocks")},Array.isArray(r)?(0,n.createElement)(n.Fragment,null,(0,d.__)("No posts found. Start publishing or add posts from an RSS feed.","coblocks"),(0,n.createElement)(m.Button,{className:"components-placeholder__cancel-button",title:(0,d.__)("Retrieve an external feed","coblocks"),isSecondary:!0,onClick:()=>{o({postFeedType:"external"})}},(0,d.__)("Use External Feed","coblocks"))):(0,n.createElement)(m.Spinner,null)))}))}}]);